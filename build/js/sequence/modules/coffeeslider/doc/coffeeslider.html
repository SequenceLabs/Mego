<!DOCTYPE html><html lang="en"><head><title>coffeeslider</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="coffeeslider"><meta name="groc-project-path" content="coffeeslider.coffee"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path">coffeeslider.coffee</div></div><div id="document"><div class="segment"><div class="comments"><div class="wrapper"><h2 id="coffeeslider">Coffeeslider</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="s2">&quot;use strict&quot;</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>namespace</p></div></div><div class="code"><div class="wrapper"><span class="nv">modules = </span><span class="nx">SEQ</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">namespace</span><span class="p">(</span><span class="s1">&#39;SEQ.modules&#39;</span><span class="p">)</span>
<span class="nv">transition = </span><span class="nx">SEQ</span><span class="p">.</span><span class="nx">effects</span><span class="p">.</span><span class="nx">Transition</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>the main Class</p></div></div><div class="code"><div class="wrapper"><span class="k">class</span> <span class="nx">modules</span><span class="p">.</span><span class="nx">CoffeeSlider</span>      </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Constructor. Creates a CoffeeSlider instance.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">constructor: </span><span class="nf">(@options) -&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h2 id="intial-settings">Intial settings</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="vi">@settings =</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>type of animation - "slide", "fade" or "slideFade"</p></div></div><div class="code"><div class="wrapper">      <span class="nv">transitionType: </span><span class="s2">&quot;slide&quot;</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>slideshow?</p></div></div><div class="code"><div class="wrapper">      <span class="nv">slideshow: </span><span class="kc">true</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>the direction of transitions</p></div></div><div class="code"><div class="wrapper">      <span class="nv">transitionDirection: </span><span class="s2">&quot;horizontal&quot;</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>duration between transitions in slideshow mode</p></div></div><div class="code"><div class="wrapper">      <span class="nv">transitionDelay: </span><span class="mi">2000</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>duration of transition</p></div></div><div class="code"><div class="wrapper">      <span class="nv">transitionSpeed: </span><span class="mi">1000</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>whether to use dot navigation</p></div></div><div class="code"><div class="wrapper">      <span class="nv">hasDotNav: </span><span class="kc">true</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>has prev/next navigation</p></div></div><div class="code"><div class="wrapper">      <span class="nv">hasPrevNext: </span><span class="kc">true</span> </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>has pagination (eg. 01/05)</p></div></div><div class="code"><div class="wrapper">      <span class="nv">hasPagination: </span><span class="kc">false</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>which style of touch interaction to use, "gesture", "inverseGesture", "drag" or "none"</p></div></div><div class="code"><div class="wrapper">      <span class="nv">touchStyle: </span><span class="s2">&quot;drag&quot;</span>                    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>"infinite" - slides loop infinitely
"return" - loops around to start/end
"none" - does nothing when it reaches the start/end</p></div></div><div class="code"><div class="wrapper">      <span class="nv">loop: </span><span class="s2">&quot;infinite&quot;</span>                      </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>preloads the images</p></div></div><div class="code"><div class="wrapper">      <span class="nv">preload: </span><span class="kc">true</span>                   </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>these are the selectors used</p></div></div><div class="code"><div class="wrapper">      <span class="nv">selectors:</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Coffeeslider uses this selector to define a slide. For example, if your 'slides' are a list, you would enter 'li' here.   </p></div></div><div class="code"><div class="wrapper">        <span class="nv">slide: </span>   <span class="s2">&quot;.slide&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The outer wrapper.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">outer: </span>   <span class="s2">&quot;.outer&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The inner wrapper.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">inner: </span>   <span class="s2">&quot;.inner&quot;</span>      </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The 'previous slide' button.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">prev: </span>    <span class="s2">&quot;.prev&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The 'next slide' button.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">next: </span>    <span class="s2">&quot;.next&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Generic button class.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">btn: </span>     <span class="s2">&quot;.btn&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>defaults to $carousel.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">uiParent: </span><span class="s2">&quot;&quot;</span>             </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Same as the uiParent but for the pagination indicators. Defaults to uiParent.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">paginationContainer: </span><span class="s2">&quot;&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The class to be used for 'dot' style navigation.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">dotNav: </span><span class="s2">&quot;.dot-nav&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The class for pagination indicators. (eg. 01/05)  </p></div></div><div class="code"><div class="wrapper">        <span class="nv">pagination: </span><span class="s2">&quot;.pagination&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The class added to the current page indicator (eg. 01/05)    </p></div></div><div class="code"><div class="wrapper">        <span class="nv">paginationCurrent: </span><span class="s2">&quot;.currentPage&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>The class added to the page total.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">paginationTotal: </span><span class="s2">&quot;.total&quot;</span>
        
      <span class="nv">callbacks:</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called after the slider is initialised. </p></div></div><div class="code"><div class="wrapper">        <span class="nv">onStart: </span><span class="o">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called each time the slide transition starts.    </p></div></div><div class="code"><div class="wrapper">        <span class="nv">onTransition: </span><span class="o">-&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called each time the slide transition completed.</p></div></div><div class="code"><div class="wrapper">        <span class="nv">onTransitionComplete: </span><span class="o">-&gt;</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Main container element - A jQuery object containing the slides.</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@container = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>outer container</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@outer = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>inner container</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@inner = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>parent for ui elements</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@uiParent = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>previous button</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@prevBtn = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>next buttin</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@nextBtn = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>array of slides</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@slides = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>width of slide</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@slideWidth = </span><span class="mi">0</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>internal states</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@currentIndex = </span><span class="mi">1000</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>number of slides</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@numSlides = </span><span class="mi">0</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>the current slide</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@currentSlide = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>is currently moving</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@isMoving = </span><span class="kc">false</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>pagination</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@pagination = </span><span class="p">{}</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>dot nav</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@dotNav = </span><span class="p">{}</span>
  
    <span class="nx">@init</span><span class="p">()</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>initialises the class</p></div></div><div class="code"><div class="wrapper">  <span class="nv">init: </span><span class="p">()</span> <span class="o">=&gt;</span>
    <span class="vi">@container = </span><span class="nx">@options</span><span class="p">.</span><span class="nx">container</span>
    <span class="nx">@container</span>
      <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;coffee-slider&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">css</span>
        <span class="nv">opacity: </span><span class="mi">1</span>
    
    <span class="nx">@applySettings</span><span class="p">()</span>
    <span class="nx">@bindToDOM</span><span class="p">()</span>
    <span class="nx">@initUI</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>init slides and pass in callback for image preloading</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@initSlides</span> <span class="o">=&gt;</span>      
      <span class="nx">@applyStyles</span><span class="p">()</span>            
      <span class="nx">@bindUIEvents</span><span class="p">()</span>
      <span class="nx">@settings</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">.</span><span class="nx">onStart</span><span class="p">()</span>
      <span class="nx">@goTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
   </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Merges user-defined options with defaults.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">applySettings</span><span class="o">:</span><span class="nf">() -&gt;</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>merge settings defaults</p></div></div><div class="code"><div class="wrapper">    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">@settings</span><span class="p">,</span> <span class="nx">@options</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Binds internal properties to DOM elements.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">bindToDOM: </span><span class="o">-&gt;</span>   </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>bind DOM references</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@slides = </span><span class="nx">@find</span><span class="p">(</span><span class="s2">&quot;slide&quot;</span><span class="p">)</span>
    <span class="vi">@numSlides = </span><span class="nx">@slides</span><span class="p">.</span><span class="nx">length</span>
    <span class="nx">@slides</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;slide&quot;</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>if inner/outer don't exist, create them</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="p">(</span><span class="vi">@inner = </span><span class="nx">@find</span><span class="p">(</span><span class="s2">&quot;inner&quot;</span><span class="p">)).</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
      <span class="nx">@slides</span><span class="p">.</span><span class="nx">wrapAll</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">@getSelector</span><span class="p">(</span><span class="s2">&quot;inner&quot;</span><span class="p">)))</span>
      <span class="vi">@inner = </span><span class="nx">@find</span><span class="p">(</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
  
    <span class="k">if</span> <span class="p">(</span><span class="vi">@outer = </span><span class="nx">@find</span><span class="p">(</span><span class="s2">&quot;outer&quot;</span><span class="p">)).</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
      <span class="nx">@inner</span><span class="p">.</span><span class="nx">wrap</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">@getSelector</span><span class="p">(</span><span class="s2">&quot;outer&quot;</span><span class="p">))</span>
      <span class="vi">@outer = </span><span class="nx">@find</span><span class="p">(</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Binds internal properties to DOM elements.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">initSlides: </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>add cloned slides for infine scrolling unless fade  </p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">is</span> <span class="s2">&quot;infinite&quot;</span> <span class="o">and</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">isnt</span> <span class="s2">&quot;fade&quot;</span>
      <span class="nx">@appendClonedSlides</span><span class="p">()</span>

    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">preload</span>
      <span class="nx">@preload</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nx">callback</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Preloads the images. </p></div></div><div class="code"><div class="wrapper">  <span class="nv">preload: </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">@outer</span><span class="p">.</span><span class="nx">css</span>
      <span class="nv">opacity: </span><span class="mi">0</span>
    <span class="vi">@images = </span><span class="nx">@container</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">)</span>
    <span class="vi">@numImages = </span><span class="nx">@images</span><span class="p">.</span><span class="nx">length</span>
    <span class="nx">@checkImagesLoaded</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Loops through each image and checks if loaded. If ready, calls the callback to continue.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">checkImagesLoaded: </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nv">imgsLoaded = </span><span class="mi">0</span>

    <span class="k">for</span> <span class="nx">img</span> <span class="k">in</span> <span class="nx">@images</span> 
      <span class="k">if</span> <span class="nx">img</span><span class="p">.</span><span class="nx">complete</span>
        <span class="nx">imgsLoaded</span><span class="o">++</span> 
        
    <span class="k">if</span> <span class="nx">imgsLoaded</span> <span class="o">is</span> <span class="nx">@numImages</span>
      <span class="nx">callback</span><span class="p">()</span>
      <span class="nx">transition</span><span class="p">.</span><span class="nx">To</span>
        <span class="nv">target: </span><span class="nx">@outer</span>
        <span class="nv">duration: </span><span class="mi">300</span>
        <span class="nv">props:</span>
          <span class="nv">opacity: </span><span class="mi">1</span>
    <span class="k">else</span>
      <span class="nx">setTimeout</span> <span class="o">=&gt;</span>
        <span class="nx">@checkImagesLoaded</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
      <span class="p">,</span> <span class="mi">100</span>
      </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Appends cloned slides to either side for purposes of creating illusion of infinite scrolling.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">appendClonedSlides: </span><span class="o">-&gt;</span>     
    <span class="nv">float = </span><span class="p">(</span><span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;horizontal&quot;</span> <span class="k">then</span> <span class="s2">&quot;left&quot;</span> <span class="k">else</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>append 1st slide to end</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@inner</span><span class="p">.</span><span class="nx">append</span> <span class="nx">@slides</span> 
      <span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">clone</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;clone&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">css</span>
        <span class="nv">float: </span><span class="nx">float</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>append last slide to start</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@inner</span><span class="p">.</span><span class="nx">prepend</span> <span class="nx">@slides</span>
      <span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="nx">@numSlides</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">clone</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;clone&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">css</span>
        <span class="nv">float: </span><span class="nx">float</span> 
        
    <span class="vi">@slides = </span><span class="nx">@find</span><span class="p">(</span><span class="s2">&quot;slide&quot;</span><span class="p">)</span>
    <span class="vi">@numSlides = </span><span class="nx">@slides</span><span class="p">.</span><span class="nx">length</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Applies some basic CSS.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">applyStyles: </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span> 
      <span class="nv">position: </span><span class="s2">&quot;relative&quot;</span>
      <span class="nv">overflow: </span><span class="s2">&quot;hidden&quot;</span>
    <span class="nx">@outer</span><span class="p">.</span><span class="nx">css</span>
      <span class="nv">overflow: </span><span class="s2">&quot;hidden&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>get width of single slide      </p></div></div><div class="code"><div class="wrapper">    <span class="vi">@slideWidth = </span><span class="nx">@slides</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="vi">@slideHeight = </span><span class="nx">@slides</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="vi">@totalWidth = </span><span class="nx">@slideWidth</span> <span class="o">*</span> <span class="nx">@numSlides</span>
    <span class="vi">@totalHeight = </span><span class="nx">@slideHeight</span> <span class="o">*</span> <span class="nx">@numSlides</span>
       
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;slide&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;slideFade&quot;</span>
      <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;horizontal&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>if using 'slide' option</p></div></div><div class="code"><div class="wrapper">        <span class="nx">@slides</span><span class="p">.</span><span class="nx">css</span>
          <span class="nv">float: </span><span class="s2">&quot;left&quot;</span>
          <span class="nv">overflow: </span><span class="s2">&quot;hidden&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>recalculate width</p></div></div><div class="code"><div class="wrapper">        <span class="vi">@slideWidth = </span><span class="nx">@slides</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
        <span class="vi">@totalWidth = </span><span class="nx">@slideWidth</span> <span class="o">*</span> <span class="nx">@numSlides</span>  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set width of inner to accomodate slides</p></div></div><div class="code"><div class="wrapper">        <span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span>
          <span class="nv">width: </span><span class="nx">@totalWidth</span>
          <span class="nv">height: </span><span class="nx">@totalHeight</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set width of outer wrapper</p></div></div><div class="code"><div class="wrapper">        <span class="nx">@outer</span><span class="p">.</span><span class="nx">css</span>
          <span class="nv">width: </span><span class="nx">@slideWidth</span>
          <span class="nv">height: </span><span class="nx">@slideHeight</span>
      <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;vertical&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set width of inner to accomodate slides</p></div></div><div class="code"><div class="wrapper">        <span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span>
          <span class="nv">height: </span><span class="nx">@totalHeight</span>
          <span class="nv">width: </span><span class="nx">@slideWidth</span>
        <span class="nx">@outer</span><span class="p">.</span><span class="nx">css</span>
          <span class="nv">height: </span><span class="nx">@slideHeight</span>
          <span class="nv">width: </span><span class="nx">@slideWidth</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span>
      <span class="nx">@slides</span><span class="p">.</span><span class="nx">css</span>
        <span class="nv">position: </span><span class="s2">&quot;absolute&quot;</span>
        <span class="nv">left: </span><span class="s2">&quot;0&quot;</span>
        <span class="nv">opacity: </span><span class="s2">&quot;0&quot;</span>
      <span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span>
        <span class="nv">width: </span><span class="nx">@slideWidth</span> 
        <span class="nv">height: </span><span class="nx">@slideHeight</span>
      <span class="nx">@outer</span><span class="p">.</span><span class="nx">css</span>
        <span class="nv">height: </span><span class="nx">@slideHeight</span>
        <span class="nv">width: </span><span class="nx">@slideWidth</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Initialises UI components.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">initUI: </span><span class="o">-&gt;</span>
    <span class="vi">@uiParent = </span><span class="nx">@getContainer</span> <span class="s2">&quot;uiParent&quot;</span><span class="p">,</span> <span class="nx">@container</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>create next/prev buttons</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasPrevNext</span>
      <span class="vi">@prevBtn = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;#{@getSelector(&quot;</span><span class="nx">prev</span><span class="s2">&quot;)}&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;#{@getSelector(&quot;</span><span class="nx">btn</span><span class="s2">&quot;)}&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;next&quot;</span><span class="p">)</span>
      <span class="vi">@nextBtn = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;#{@getSelector(&quot;</span><span class="nx">next</span><span class="s2">&quot;)}&quot;</span><span class="p">)</span> 
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;#{@getSelector(&quot;</span><span class="nx">btn</span><span class="s2">&quot;)}&quot;</span><span class="p">)</span>        
        <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;prev&quot;</span><span class="p">)</span> 
      <span class="nx">@uiParent</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">@prevBtn</span><span class="p">)</span>
      <span class="nx">@uiParent</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">@nextBtn</span><span class="p">)</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>create dot navigation</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasDotNav</span>
      <span class="vi">@dotNav = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;nav /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">@getSelector</span><span class="p">(</span><span class="s2">&quot;dotNav&quot;</span><span class="p">))</span>
      <span class="nx">@uiParent</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">@dotNav</span><span class="p">)</span>
      <span class="nx">@dotNav</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;ol /&gt;&quot;</span><span class="p">))</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>loop through slides</p></div></div><div class="code"><div class="wrapper">      <span class="k">for</span> <span class="nx">slide</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">@slides</span>
        <span class="nx">@dotNav</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;ol&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;li&gt;#{i}&lt;/li&gt;&quot;</span><span class="p">)</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>create pagination</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasPagination</span>   
      <span class="vi">@pagination = </span><span class="k">new</span> <span class="nx">modules</span><span class="p">.</span><span class="nx">Pagination</span><span class="p">(</span>
        <span class="nx">@getContainer</span><span class="p">(</span><span class="s2">&quot;paginationContainer&quot;</span><span class="p">,</span> <span class="nx">@uiParent</span><span class="p">),</span> 
        <span class="nx">@getSelector</span><span class="p">(</span><span class="s2">&quot;pagination&quot;</span><span class="p">),</span> 
        <span class="nx">@getSelector</span><span class="p">(</span><span class="s2">&quot;paginationCurrent&quot;</span><span class="p">),</span>
        <span class="nx">@getSelector</span><span class="p">(</span><span class="s2">&quot;paginationTotal&quot;</span><span class="p">),</span>
        <span class="nx">@numSlides</span>
      <span class="p">)</span> 
      </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Removes UI components.</p></div></div><div class="code"><div class="wrapper">  <span class="nx">@private</span>
  <span class="nv">removeUI: </span><span class="o">-&gt;</span>
    <span class="nx">@nextBtn</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
    <span class="nx">@prevBtn</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Binds event-handling to user controls.       </p></div></div><div class="code"><div class="wrapper">  <span class="nv">bindUIEvents: </span><span class="o">=&gt;</span>
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasPrevNext</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>next / back click events</p></div></div><div class="code"><div class="wrapper">      <span class="nx">@nextBtn</span><span class="p">.</span><span class="nx">bind</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
        <span class="nx">@next</span><span class="p">()</span>
      <span class="nx">@prevBtn</span><span class="p">.</span><span class="nx">bind</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
        <span class="nx">@prev</span><span class="p">()</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h1 id="pagination-click-events">pagination click events</h1></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasDotNav</span>
      <span class="nx">@dotNav</span><span class="p">.</span><span class="nx">bind</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
        <span class="nx">@goTo</span> <span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">index</span><span class="p">(),</span> <span class="kc">false</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>touch events</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@inner</span><span class="p">.</span><span class="nx">bind</span> <span class="s2">&quot;touchstart&quot;</span><span class="p">,</span> <span class="nx">@onTouchStart</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">touchStyle</span> <span class="o">isnt</span> <span class="s2">&quot;none&quot;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Initialises the slideshow, if needed.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">initSlideshow: </span><span class="o">=&gt;</span>    
    <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">@timer</span><span class="p">)</span>
    <span class="vi">@timer = </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">@onSlideshowTick</span><span class="p">,</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDelay</span><span class="p">)</span>
    
  <span class="nv">onSlideshowTick: </span><span class="p">()</span> <span class="o">=&gt;</span>
    <span class="nx">@next</span><span class="p">()</span>
        </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called when a touch start event fires.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">onTouchStart: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="vi">@innerLeft = </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">))</span>
    <span class="vi">@innerTop = </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">))</span>
    <span class="vi">@startX = </span><span class="nv">endX = </span><span class="nx">e</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageX</span>
    <span class="vi">@startY = </span><span class="nv">endY = </span><span class="nx">e</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageY</span>        
    <span class="vi">@distanceMovedX = </span><span class="mi">0</span>
    <span class="vi">@distanceMovedY = </span><span class="mi">0</span>
        
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;touchend&quot;</span><span class="p">,</span> <span class="nx">@onTouchEndOrCancel</span><span class="p">)</span>
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;touchcancel&quot;</span><span class="p">,</span> <span class="nx">@onTouchEndOrCancel</span><span class="p">)</span>
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">@onTouchMove</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">slideshow</span>
      <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">@timer</span><span class="p">)</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called when a touch event finishes.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">onTouchEndOrCancel: </span><span class="p">(</span> <span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;touchend&quot;</span><span class="p">,</span> <span class="nx">@onTouchEndOrCancel</span><span class="p">)</span>
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;touchcancel&quot;</span><span class="p">,</span> <span class="nx">@onTouchEndOrCancel</span><span class="p">)</span>
    <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">@onTouchMove</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;horizontal&quot;</span>    
      <span class="k">if</span> <span class="nx">@distanceMovedX</span> <span class="o">&gt;</span> <span class="mi">50</span>
        <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">touchStyle</span> <span class="o">is</span> <span class="s2">&quot;inverseGesture&quot;</span>
          <span class="nx">@prev</span><span class="p">()</span>
        <span class="k">else</span>
          <span class="nx">@next</span><span class="p">()</span>
      <span class="k">else</span> <span class="k">if</span> <span class="nx">@distanceMovedX</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span>
        <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">touchStyle</span> <span class="o">is</span> <span class="s2">&quot;inverseGesture&quot;</span>
          <span class="nx">@next</span><span class="p">()</span>
        <span class="k">else</span>
          <span class="nx">@prev</span><span class="p">()</span>
      <span class="k">else</span>
        <span class="nx">@goTo</span> <span class="nx">@currentIndex</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;vertical&quot;</span>    
      <span class="k">if</span> <span class="nx">@distanceMovedY</span> <span class="o">&gt;</span> <span class="mi">50</span>
        <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">touchStyle</span> <span class="o">is</span> <span class="s2">&quot;inverseGesture&quot;</span>
          <span class="nx">@prev</span><span class="p">()</span>
        <span class="k">else</span>
          <span class="nx">@next</span><span class="p">()</span>
      <span class="k">else</span> <span class="k">if</span> <span class="nx">@distanceMovedY</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span>
        <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">touchStyle</span> <span class="o">is</span> <span class="s2">&quot;inverseGesture&quot;</span>
          <span class="nx">@next</span><span class="p">()</span>
        <span class="k">else</span>
          <span class="nx">@prev</span><span class="p">()</span>
      <span class="k">else</span>
        <span class="nx">@goTo</span> <span class="nx">@currentIndex</span>
                           </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called when a touch move event fires.     </p></div></div><div class="code"><div class="wrapper">  <span class="nv">onTouchMove: </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="vi">@endX = </span><span class="nx">e</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageX</span>  
    <span class="vi">@endY = </span><span class="nx">e</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageY</span>
    
    <span class="vi">@distanceMovedX = </span><span class="nx">@startX</span> <span class="o">-</span> <span class="nx">@endX</span>
    <span class="vi">@distanceMovedY = </span><span class="nx">@startY</span> <span class="o">-</span> <span class="nx">@endY</span>
                                 
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;horizontal&quot;</span>
      <span class="k">if</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">@distanceMovedX</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>     
      <span class="k">else</span> <span class="k">if</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">@distanceMovedY</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span>
        <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">@onTouchMove</span>
    
    <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;vertical&quot;</span>
      <span class="k">if</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">@distanceMovedY</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>     
      <span class="k">else</span> <span class="k">if</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">@distanceMovedX</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span>
        <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">@onTouchMove</span>
    
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">touchStyle</span> <span class="o">is</span> <span class="s2">&quot;drag&quot;</span>     
      <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;horizontal&quot;</span>
        <span class="nv">dragPosX = </span><span class="nx">@innerLeft</span> <span class="o">-</span> <span class="p">(</span><span class="nx">@startX</span> <span class="o">-</span> <span class="nx">@endX</span><span class="p">)</span> 
        <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">isnt</span> <span class="s2">&quot;infinite&quot;</span> <span class="o">and</span> <span class="p">(</span><span class="nx">dragPosX</span> <span class="o">&gt;=</span> <span class="mi">10</span>  <span class="o">or</span> <span class="nx">dragPosX</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">-</span> <span class="p">(</span><span class="nx">@totalWidth</span> <span class="o">-</span> <span class="nx">@slideWidth</span> <span class="o">-</span> <span class="mi">10</span><span class="p">))</span>
          <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">@onTouchMove</span>
          <span class="vi">@distanceMovedX = </span><span class="mi">0</span>
        <span class="k">else</span>
          <span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span>
            <span class="nv">left: </span><span class="nx">dragPosX</span>           
      <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;vertical&quot;</span>
        <span class="nv">dragPosY = </span><span class="nx">@innerTop</span> <span class="o">-</span> <span class="p">(</span><span class="nx">@startY</span> <span class="o">-</span> <span class="nx">@endY</span><span class="p">)</span> 
        <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">isnt</span> <span class="s2">&quot;infinite&quot;</span> <span class="o">and</span> <span class="nx">dragPosY</span> <span class="o">&gt;=</span> <span class="mi">10</span>
          <span class="nx">@inner</span><span class="p">.</span><span class="nx">unbind</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">@onTouchMove</span>
          <span class="vi">@distanceMovedY = </span><span class="mi">0</span>
        <span class="k">else</span>  
          <span class="nx">@inner</span><span class="p">.</span><span class="nx">css</span>
            <span class="nv">top: </span><span class="nx">dragPosY</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Goes to a specific slide (as indicated).</p></div></div><div class="code"><div class="wrapper">  <span class="nv">goTo: </span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span> <span class="o">=&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>dont proceed if still moving or attempt to goto the current frame
return false if @isMoving or @currentIndex is index  </p></div></div><div class="code"><div class="wrapper">    <span class="nx">@settings</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">.</span><span class="nx">onTransition</span><span class="p">()</span>

    <span class="k">if</span> <span class="o">!</span><span class="nx">skipTransition</span>
      <span class="vi">@isMoving = </span><span class="kc">true</span>    
     
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;slide&quot;</span>
      <span class="nx">@slideTo</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span>
      <span class="nx">@fadeTo</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;slideFade&quot;</span>
      <span class="nx">@slideFadeTo</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>update dotnav</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasDotNav</span>
      <span class="nv">ACTIVE = </span><span class="s2">&quot;active&quot;</span>
      <span class="nx">@dotNav</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;.#{ACTIVE}&quot;</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">ACTIVE</span><span class="p">)</span>
      <span class="nx">@dotNav</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">).</span><span class="nx">eq</span><span class="p">(</span><span class="nx">index</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">ACTIVE</span><span class="p">)</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>update pagination </p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">hasPagination</span>    
      <span class="k">if</span> <span class="nx">@currentIndex</span> <span class="o">&lt;</span> <span class="mi">0</span>
        <span class="nx">@pagination</span><span class="p">.</span><span class="nx">setPage</span> <span class="nx">@numSlides</span> <span class="o">-</span> <span class="mi">2</span> 
      <span class="k">else</span> <span class="k">if</span> <span class="nx">@currentIndex</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nx">@numSlides</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
        <span class="nx">@pagination</span><span class="p">.</span><span class="nx">setPage</span> <span class="mi">1</span>
      <span class="k">else</span>
        <span class="nx">@pagination</span><span class="p">.</span><span class="nx">setPage</span> <span class="nx">@currentIndex</span> <span class="o">+</span> <span class="mi">1</span>
        
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">slideshow</span>
      <span class="nx">@initSlideshow</span><span class="p">()</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Uses the 'slide' animation to move to a slide.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">slideTo: </span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span> <span class="o">=&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>record the current index</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@currentIndex = </span><span class="nx">index</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>offset to compensate for extra slide if in infinite mode</p></div></div><div class="code"><div class="wrapper">    <span class="nv">offset = </span><span class="p">(</span><span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">is</span> <span class="s2">&quot;infinite&quot;</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>       
    
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;horizontal&quot;</span>
      <span class="nv">position = left: </span><span class="mi">0</span> <span class="o">-</span> <span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="nx">offset</span><span class="p">)</span> <span class="o">*</span> <span class="nx">@slideWidth</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionDirection</span> <span class="o">is</span> <span class="s2">&quot;vertical&quot;</span>
      <span class="nv">position = top: </span><span class="mi">0</span> <span class="o">-</span> <span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="nx">offset</span><span class="p">)</span> <span class="o">*</span> <span class="nx">@slideHeight</span>
 
    <span class="nx">transition</span><span class="p">.</span><span class="nx">To</span>
      <span class="nv">target: </span><span class="nx">@inner</span>
      <span class="nv">props: </span><span class="nx">position</span>    
      <span class="nv">duration: </span><span class="k">if</span> <span class="nx">skipTransition</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionSpeed</span> <span class="err">/ 2</span>
      <span class="nv">complete: </span><span class="nx">@onTransitionComplete</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>fades to the index</p></div></div><div class="code"><div class="wrapper">  <span class="nv">fadeTo: </span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span> <span class="o">=&gt;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>fade out the current slide, if it exists</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">@slides</span><span class="p">[</span><span class="nx">@currentIndex</span><span class="p">]</span><span class="o">?</span>
      <span class="nx">transition</span><span class="p">.</span><span class="nx">To</span>
        <span class="nv">target: </span><span class="nx">@slides</span><span class="p">[</span><span class="nx">@currentIndex</span><span class="p">]</span>
        <span class="nv">props:</span>
          <span class="nv">opacity: </span><span class="mi">0</span>
        <span class="nv">duration: </span><span class="k">if</span> <span class="nx">skipTransition</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionSpeed</span> <span class="err">/ 2 </span>
        </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>record the current index</p></div></div><div class="code"><div class="wrapper">    <span class="vi">@currentIndex = </span><span class="nx">index</span>
    
    <span class="nx">transition</span><span class="p">.</span><span class="nx">To</span>
      <span class="nv">target: </span><span class="nx">@slides</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span>
      <span class="nv">props:</span>
        <span class="nv">opacity: </span><span class="mi">1</span>
      <span class="nv">duration: </span><span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionSpeed</span>
      <span class="nv">complete: </span><span class="nx">@onTransitionComplete</span>
       </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Uses the 'slideFade' animation to move to a slide.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">slideFadeTo: </span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">@fadeTo</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span>      
    <span class="nx">@slideTo</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">skipTransition</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Goes to the previous page.  </p></div></div><div class="code"><div class="wrapper">  <span class="nv">prev: </span><span class="o">-&gt;</span>
    <span class="nv">prevIndex = </span> <span class="nx">@currentIndex</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">is</span> <span class="s2">&quot;return&quot;</span><span class="p">)</span> <span class="o">and</span> <span class="nx">prevIndex</span> <span class="o">&lt;</span> <span class="mi">0</span>
      <span class="nv">prevIndex = </span><span class="p">(</span><span class="nx">@numSlides</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nx">@goTo</span> <span class="nx">prevIndex</span><span class="p">,</span> <span class="kc">false</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Goes to the next page. </p></div></div><div class="code"><div class="wrapper">  <span class="nv">next: </span><span class="o">-&gt;</span>  
    <span class="nv">nextIndex = </span><span class="nx">@currentIndex</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nx">nextIndex</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nx">@numSlides</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">is</span> <span class="s2">&quot;fade&quot;</span> <span class="o">or</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">is</span> <span class="s2">&quot;return&quot;</span><span class="p">)</span> 
        <span class="nv">nextIndex = </span><span class="mi">0</span>
      <span class="k">else</span> <span class="k">if</span> <span class="o">not</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span>
        <span class="k">return</span>
        
    <span class="nx">@goTo</span> <span class="nx">nextIndex</span><span class="p">,</span> <span class="kc">false</span>
        </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Called whenever a slide transition completes.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">onTransitionComplete: </span><span class="p">()</span> <span class="o">=&gt;</span>
    <span class="vi">@isMoving = </span><span class="kc">false</span>
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">is</span> <span class="s2">&quot;infinite&quot;</span> <span class="o">and</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">transitionType</span> <span class="o">isnt</span> <span class="s2">&quot;fade&quot;</span>
      <span class="k">if</span> <span class="nx">@currentIndex</span> <span class="o">is</span> <span class="o">-</span><span class="mi">1</span>
        <span class="nx">@goTo</span> <span class="nx">@numSlides</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">true</span>
      <span class="k">else</span> <span class="k">if</span> <span class="nx">@currentIndex</span> <span class="o">is</span> <span class="nx">@numSlides</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="nx">@goTo</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">true</span>
      <span class="k">else</span>
        <span class="nx">@settings</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">.</span><span class="nx">onTransitionComplete</span><span class="p">()</span>
    <span class="k">else</span>
      <span class="nx">@settings</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">.</span><span class="nx">onTransitionComplete</span><span class="p">()</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Utility function. Finds an element in the container for a given selector in the selectors object.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">find: </span><span class="p">(</span><span class="nx">selectorName</span><span class="p">)</span> <span class="o">=&gt;</span> 
    <span class="nx">@container</span><span class="p">.</span><span class="nx">find</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">selectors</span><span class="p">[</span><span class="nx">selectorName</span><span class="p">]</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Utility function. Gets a container.      </p></div></div><div class="code"><div class="wrapper">  <span class="nv">getContainer: </span><span class="nf">(name, _default) -&gt;</span> 
    <span class="k">if</span> <span class="nx">@settings</span><span class="p">.</span><span class="nx">selectors</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">is</span> <span class="s2">&quot;&quot;</span> <span class="k">then</span> <span class="nx">_default</span> <span class="k">else</span> <span class="nx">@find</span> <span class="nx">name</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Utility function. Gets a container. </p></div></div><div class="code"><div class="wrapper">  <span class="nv">getSelector: </span><span class="nf">(name) -&gt;</span>
    <span class="nv">selector = </span><span class="nx">@settings</span><span class="p">.</span><span class="nx">selectors</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span>
    <span class="nx">selector</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>

    
<span class="k">class</span> <span class="nx">modules</span><span class="p">.</span><span class="nx">Pagination</span>
  
  <span class="nx">paginationCurrent</span><span class="o">:</span><span class="p">{}</span>
  <span class="nx">paginationTotal</span><span class="o">:</span><span class="p">{}</span>
    
  <span class="nv">constructor: </span><span class="nf">(paginationContainer, paginationSel, paginationCurrentSel, paginationTotalSel, numSlides) -&gt;</span>
  
    <span class="nv">pagination = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">paginationSel</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
      <span class="vi">@paginationCurrent = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;span /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">paginationCurrentSel</span><span class="p">),</span>
      <span class="vi">@paginationTotal = </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;span /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">paginationTotalSel</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;/0#{numSlides}&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="nv">i = </span><span class="mi">1</span>
    
    <span class="k">while</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">numSlides</span>
      <span class="nx">@paginationCurrent</span><span class="p">.</span><span class="nx">append</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">&quot;0#{i}&quot;</span><span class="p">)</span> 
      <span class="nx">i</span><span class="o">++</span>
    
    <span class="nx">paginationContainer</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">pagination</span><span class="p">)</span>
    
  <span class="nv">setPage: </span><span class="nf">(index) -&gt;</span>
      
    <span class="nx">SEQ</span><span class="p">.</span><span class="nx">Tween</span><span class="p">.</span><span class="nx">To</span>
      <span class="nv">target : </span><span class="nx">@paginationCurrent</span>
      <span class="nv">props :</span>
        <span class="nv">top : </span><span class="s2">&quot;-#{@paginationCurrent.find(&#39;.number&#39;).outerHeight() * (index-1)}px&quot;</span>
      <span class="nv">duration : </span><span class="mi">500</span></div></div></div></div></body></html>